# =============================================================================
# RSession Configuration for R 4.5.1 - Optimized Multi-User Environment
# This file configures individual R sessions within RStudio Server
# Supports users: cdsw, dev1, dev2
# Container: 28GB RAM available
# =============================================================================

# =============================================================================
# CPU AND PERFORMANCE OPTIMIZATIONS
# Settings that affect CPU usage, session startup, and general performance
# =============================================================================

# Session timeout (0 = no timeout for long-running data science tasks)
session-timeout-minutes=0

# Disable session suspension for better performance in containers
session-suspensions-enabled=0

# Faster session startup - don't load .Rprofile on resume   
session-rprofile-on-resume-default=0

# Disable help home page for faster startup
show-help-home=0

# Enable auto-reload of source files during development
r-auto-reload-source=1

# =============================================================================
# MEMORY MANAGEMENT SETTINGS
# Configuration for memory allocation, limits, and usage patterns
# =============================================================================

# R command line arguments with memory optimization
r-command-line-arguments=--no-save --no-restore --max-mem-size=20G --max-ppsize=500000

# Set larger memory thresholds before GC kicks in (20GB in bytes)
r-environ-R_MAX_MEM_SIZE=21474836480

# =============================================================================
# GARBAGE COLLECTION OPTIMIZATIONS
# Advanced GC tuning for large dataset processing and memory efficiency
# =============================================================================

# Memory management for large datasets - disable verbose GC reports
r-gc-mem-reports=0

# Memory growth strategy: triple memory on each GC (vs default double)
r-environ-R_GC_MEM_GROW=3

# Larger heap sizes for better performance with big data
r-environ-R_NSIZE=1000000      # Node heap size (default: 350000)
r-environ-R_VSIZE=33554432     # Vector heap size (default: 16777216)

# Disable GC torture mode for production performance
r-environ-R_GCTORTURE=0

# =============================================================================
# PACKAGE MANAGEMENT AND REPOSITORIES
# Settings for R package installation and CRAN repositories
# =============================================================================

# Allow users to install packages
allow-package-installation=1

# Shared package library location for all users
r-libs-user=/usr/local/lib/R/site-library

# Default CRAN mirror
r-cran-repos=https://cloud.r-project.org/

# =============================================================================
# USER ENVIRONMENT AND WORKSPACE SETTINGS
# Configuration for user sessions, working directories, and workspace behavior
# =============================================================================

# Default working directory for new sessions (~ = user's home directory)
session-default-working-dir=~

# Save workspace behavior (recommended: never for reproducible research)
session-save-action-default=no

# =============================================================================
# SECURITY AND ACCESS CONTROL
# Settings that control user access to files and system resources
# =============================================================================

# Allow directory browsing (useful for data science workflows)
restrict-directory-view=0

# Show hidden files (useful for configuration files)
show-hidden-files=1
